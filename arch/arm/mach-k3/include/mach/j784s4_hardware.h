/* SPDX-License-Identifier: GPL-2.0-or-later */
/*
 * K3: J784S4 SoC definitions, structures etc.
 *
 * Copyright (C) 2023-2024 Texas Instruments Incorporated - https://www.ti.com/
 */
#ifndef __ASM_ARCH_J784S4_HARDWARE_H
#define __ASM_ARCH_J784S4_HARDWARE_H

#ifndef __ASSEMBLY__
#include <linux/bitops.h>
#endif

#define WKUP_CTRL_MMR0_BASE				0x43000000
#define MCU_CTRL_MMR0_BASE				0x40f00000
#define CTRL_MMR0_BASE					0x00100000

#define CTRLMMR_MAIN_DEVSTAT				(CTRL_MMR0_BASE + 0x30)
#define MAIN_DEVSTAT_BOOT_MODE_B_MASK			BIT(0)
#define MAIN_DEVSTAT_BOOT_MODE_B_SHIFT			0
#define MAIN_DEVSTAT_BKUP_BOOTMODE_MASK			GENMASK(3, 1)
#define MAIN_DEVSTAT_BKUP_BOOTMODE_SHIFT		1
#define MAIN_DEVSTAT_PRIM_BOOTMODE_MMC_PORT_MASK	BIT(6)
#define MAIN_DEVSTAT_PRIM_BOOTMODE_PORT_SHIFT		6
#define MAIN_DEVSTAT_BKUP_MMC_PORT_MASK			BIT(7)
#define MAIN_DEVSTAT_BKUP_MMC_PORT_SHIFT		7

#define CTRLMMR_WKUP_DEVSTAT				(WKUP_CTRL_MMR0_BASE + 0x30)
#define WKUP_DEVSTAT_PRIMARY_BOOTMODE_MASK		GENMASK(5, 3)
#define WKUP_DEVSTAT_PRIMARY_BOOTMODE_SHIFT		3
#define WKUP_DEVSTAT_MCU_ONLY_MASK			BIT(6)
#define WKUP_DEVSTAT_MCU_ONLY_SHIFT			6

/* WKUP CTRL MMR HW POST Registers */
#define WKUP_CTRL_MMR_POST_STAT				0x0000C2C0
#define WKUP_CTRL_MMR_POST_STAT_PBIST_DONE_SHIFT	0x00000008
#define WKUP_CTRL_MMR_POST_STAT_PBIST_TIMEOUT_SHIFT	0x00000009
#define WKUP_CTRL_MMR_POST_STAT_PBIST_FAIL_MASK		0x00008000

/* CTRL MMR PBIST Registers */
#define CTRL_MMR_CFG0_WKUP_BOOTCFG			(WKUP_CTRL_MMR0_BASE + 0x34)
#define WKUP_BOOTCFG_MCU_BOOTMODE_POST_MASK		GENMASK(9, 8)
#define WKUP_BOOTCFG_MCU_BOOTMODE_POST_SHIFT		8

/* Properties of PBIST instances in: PBIST14 */
#define PBIST14_INSTANCE				14
#define PBIST14_NUM_TEST_VECTORS			0x1
#define PBIST14_ALGO_BITMAP_0				0x00000003
#define PBIST14_MEM_BITMAP_0				0x000CCCCC
#define PBIST14_FAIL_VECTOR_CA0				0x00000000
#define PBIST14_FAIL_VECTOR_CA1				0x000001ff
#define PBIST14_FAIL_VECTOR_CA2				0x000001ff
#define PBIST14_FAIL_VECTOR_CA3				0x00000000
#define PBIST14_FAIL_VECTOR_CL0				0x0000007f
#define PBIST14_FAIL_VECTOR_CL1				0x00000003
#define PBIST14_FAIL_VECTOR_CL2				0x00000008
#define PBIST14_FAIL_VECTOR_CL3				0x000001ff
#define PBIST14_FAIL_VECTOR_CMS				0x00000000
#define PBIST14_FAIL_VECTOR_CSR				0x20000000
#define PBIST14_FAIL_VECTOR_I0				0x00000001
#define PBIST14_FAIL_VECTOR_I1				0x00000004
#define PBIST14_FAIL_VECTOR_I2				0x00000008
#define PBIST14_FAIL_VECTOR_I3				0x00000000
#define PBIST14_FAIL_VECTOR_RAMT			0x011d2528
#define PBIST14_FAIL_VECTOR_RF0L			0x00000001
#define PBIST14_FAIL_VECTOR_RF0U			0x00003123
#define PBIST14_FAIL_VECTOR_RF1L			0x0513FC02
#define PBIST14_FAIL_VECTOR_RF1U			0x00000002
#define PBIST14_FAIL_VECTOR_RF2L			0x00000003
#define PBIST14_FAIL_VECTOR_RF2U			0x00000000
#define PBIST14_FAIL_VECTOR_RF3L			0x00000004
#define PBIST14_FAIL_VECTOR_RF3U			0x00000028
#define PBIST14_FAIL_VECTOR_RF4L			0x64000044
#define PBIST14_FAIL_VECTOR_RF4U			0x00000000
#define PBIST14_FAIL_VECTOR_RF5L			0x0006A006
#define PBIST14_FAIL_VECTOR_RF5U			0x00000000
#define PBIST14_FAIL_VECTOR_RF6L			0x00000007
#define PBIST14_FAIL_VECTOR_RF6U			0x0000A0A0
#define PBIST14_FAIL_VECTOR_RF7L			0x00000008
#define PBIST14_FAIL_VECTOR_RF7U			0x00000064
#define PBIST14_FAIL_VECTOR_RF8L			0x00000009
#define PBIST14_FAIL_VECTOR_RF8U			0x0000A5A5
#define PBIST14_FAIL_VECTOR_RF9L			0x0000000A
#define PBIST14_FAIL_VECTOR_RF9U			0x00000079
#define PBIST14_FAIL_VECTOR_RF10L			0x00000000
#define PBIST14_FAIL_VECTOR_RF10U			0x00000001
#define PBIST14_FAIL_VECTOR_D				0xAAAAAAAA
#define PBIST14_FAIL_VECTOR_E				0xAAAAAAAA
#define PBIST14_ROM_VECTOR_D				0xf412605e
#define PBIST14_ROM_VECTOR_E				0xf412605e
#define PBIST14_ROM_VECTOR_CA2				0x00007fff
#define PBIST14_ROM_VECTOR_CL0				0x000003ff
#define PBIST14_ROM_VECTOR_CA3				0x00000000
#define PBIST14_ROM_VECTOR_I0				0x00000001
#define PBIST14_ROM_VECTOR_CL1				0x0000001f
#define PBIST14_ROM_VECTOR_I3				0x00000000
#define PBIST14_ROM_VECTOR_I2				0x0000000e
#define PBIST14_ROM_VECTOR_CL2				0x0000000e
#define PBIST14_ROM_VECTOR_CA1				0x00007fff
#define PBIST14_ROM_VECTOR_CA0				0x00000000
#define PBIST14_ROM_VECTOR_CL3				0x00007fff
#define PBIST14_ROM_VECTOR_I1				0x00000020
#define PBIST14_ROM_VECTOR_RAMT				0x08002020
#define PBIST14_ROM_VECTOR_CSR				0x00000001
#define PBIST14_ROM_VECTOR_CMS				0x00000001
#define PBIST14_ROM_VECTOR_RF0L				0x00000001
#define PBIST14_ROM_VECTOR_RF0U				0x00003123
#define PBIST14_ROM_VECTOR_RF1L				0x7A400183
#define PBIST14_ROM_VECTOR_RF1U				0x00000060
#define PBIST14_ROM_VECTOR_RF2L				0x00000184
#define PBIST14_ROM_VECTOR_RF2U				0x00000000
#define PBIST14_ROM_VECTOR_RF3L				0x7B600181
#define PBIST14_ROM_VECTOR_RF3U				0x00000061
#define PBIST14_ROM_VECTOR_RF4L				0x00000000
#define PBIST14_ROM_VECTOR_RF4U				0x00000000

/* ROM HANDOFF Structure location */
#define ROM_EXTENDED_BOOT_DATA_INFO			0x41cfdb00

/* MCU SCRATCHPAD usage */
#define TI_SRAM_SCRATCH_BOARD_EEPROM_START	CONFIG_SYS_K3_MCU_SCRATCHPAD_BASE

#if defined(CONFIG_SYS_K3_SPL_ATF) && !defined(__ASSEMBLY__)

#define J784S4_DEV_MCU_RTI0			367
#define J784S4_DEV_MCU_RTI1			368
#define J784S4_DEV_MCU_ARMSS0_CPU0		346
#define J784S4_DEV_MCU_ARMSS0_CPU1		347

static const u32 put_device_ids[] = {
	J784S4_DEV_MCU_RTI0,
	J784S4_DEV_MCU_RTI1,
};

static const u32 put_core_ids[] = {
	J784S4_DEV_MCU_ARMSS0_CPU1,
	J784S4_DEV_MCU_ARMSS0_CPU0,     /* Handle CPU0 after CPU1 */
};

#endif

#endif /* __ASM_ARCH_J784S4_HARDWARE_H */
